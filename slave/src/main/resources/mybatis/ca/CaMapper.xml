<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.higgs.trust.slave.dao.ca.CaDao">

    <insert id="insertCa" parameterType="com.higgs.trust.slave.dao.po.ca.CaPO">
		INSERT INTO ca(version,
								period,
								valid,
								pub_key,
								`user`,
								`usage`,
								height,
								create_time,
								update_time)
					  VALUES (#{version},
					  			#{period},
					  			#{valid},
					  			#{pubKey},
					  			#{user},
					  			#{usage},
					  			#{height},
					  			now(3),
					  			now(3))
	</insert>


    <update id="updateCa" parameterType="com.higgs.trust.slave.dao.po.ca.CaPO">
		UPDATE ca SET
		            height=#{height},
		            period=#{period},
		            pub_key=#{pubKey},
		            update_time=now(3)
		          WHERE `user`=#{user} and valid='TRUE'
	</update>


    <select id="getCa" parameterType="java.lang.String"
            resultType="com.higgs.trust.slave.dao.po.ca.CaPO">
		SELECT    version as version,
								period as period,
								valid as valid,
								pub_key as pubKey,
								`user` as `user`,
								`usage` as `usage`,
								height as height,
								create_time as createTime,
								update_time as updateTime
		      FROM ca WHERE `user`=#{user} and valid='TRUE'
	</select>

    <select id="getAllCa"  resultType="com.higgs.trust.slave.dao.po.ca.CaPO">
		SELECT    version as version,
				period as period,
				valid as valid,
				pub_key as pubKey,
				`user` as `user`,
				`usage` as `usage`,
				create_time as createTime,
				update_time as updateTime
		FROM ca WHERE valid='TRUE'
	</select>


</mapper>
