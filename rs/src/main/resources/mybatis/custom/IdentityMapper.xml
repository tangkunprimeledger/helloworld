<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.higgs.trust.rs.custom.dao.identity.IdentityDAO">

    <insert id="insertIdentity" parameterType="com.higgs.trust.rs.custom.dao.po.identity.IdentityPO">
		INSERT INTO identity(request_id,
								`key`,
								`value`,
								create_time,
								update_time)
					  VALUES (#{reqNo},
					  			#{key},
					  			#{value},
					  			now(),
					  			now())
					  ON DUPLICATE KEY UPDATE request_id=#{reqNo},`value`=#{value},update_time=now()
	</insert>


    <select id="queryIdentityByKey" parameterType="java.lang.String"
            resultType="com.higgs.trust.rs.custom.dao.po.identity.IdentityPO">
		SELECT id as id,
				`key` as `key`,
				`value` as `value`,
				request_id as reqNo,
				create_time as createTime,
				update_time as updateTime
		FROM identity WHERE `key` = #{key}
	</select>

    <select id="queryIdentityByReqNo" parameterType="java.lang.String"
            resultType="com.higgs.trust.rs.custom.dao.po.identity.IdentityPO">
		SELECT id as id,
				`key` as `key`,
				`value` as `value`,
				request_id as reqNo,
				create_time as createTime,
				update_time as updateTime
		FROM identity WHERE request_id = #{reqNo}
	</select>

</mapper>
